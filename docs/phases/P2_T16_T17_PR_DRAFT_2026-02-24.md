# PR Draft: P2-T16 / P2-T17

## Title

`[P2-T16/P2-T17] Canonical envelope completion + route guardrail matrix expansion`

## Body

```md
## Scope

Completes Phase 2 review items for:
- P2-T16C/T16D (success envelope standardization + frontend/e2e envelope alignment)
- P2-T17A/T17C/T17D/T17E (guardrail matrix expansion, helper compatibility, verification/cov-gate sync)

## Non-Scope

- No new feature work outside P2-T16/T17
- No reopening of P3-T5 (remains blocked for post-P2 review cycle)
- No coverage threshold decreases

## Behavioral Compatibility

Successful API responses now consistently expose canonical envelope fields:
- `success: true`
- `data: <payload>`

Compatibility is preserved for object payloads by retaining existing top-level fields.

## Verification

- make lint ✅
- make typecheck ✅
- cd backend && npm run test -- src/__tests__/integration/routeGuardrails.test.ts --runInBand ✅
- cd backend && npm run test:integration ✅
- make test-frontend ✅
- cd e2e && npm run test:smoke ✅
- make test-backend ✅

## Risks

- Medium: response-shape compatibility across legacy consumers.
- Mitigation: compatibility-safe object wrapping and full integration + frontend/e2e verification.

## Rollback

- Revert this PR commit set.
- Re-run `make lint`, `make typecheck`, `cd backend && npm run test:integration`.
```

## Reviewer Checklist

- [ ] Success envelopes are canonical on all touched API paths.
- [ ] Legacy object-response compatibility remains intact (top-level fields preserved).
- [ ] Guardrail matrix includes expanded auth/validation/success/correlation checks.
- [ ] E2E helper envelope parsing no longer depends on brittle nested data assumptions.
- [ ] Success-envelope baseline ratchet did not increase any counts.
- [ ] Verification matrix in PR body matches executed commands and passing outcomes.

